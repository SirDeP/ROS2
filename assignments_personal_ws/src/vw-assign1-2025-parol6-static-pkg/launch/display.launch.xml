<launch>
  <!-- Existing robot -->
  <let name="urdf_path" value="$(find-pkg-share vw-assign1-2025-parol6-static-pkg)/urdf/PAROL6.urdf.xacro"/>
  <let name="rviz_config_path" value="$(find-pkg-share vw-assign1-2025-parol6-static-pkg)/rviz/urdf_config.rviz"/>

  <!-- Connect4 URDF -->
  <let name="connect4_urdf_path" value="$(find-pkg-share vw-assign1-2025-parol6-static-pkg)/urdf/connect4.urdf.xacro"/>

  <!-- Place Connect4 with CLI-overridable args -->
  <arg name="x" default="0.60"/>
  <arg name="y" default="0.00"/>
  <arg name="z" default="0.00"/>
  <arg name="roll" default="0.0"/>
  <arg name="pitch" default="0.0"/>
  <arg name="yaw" default="0.0"/>

  <!-- Robot -->
  <node pkg="robot_state_publisher" exec="robot_state_publisher" name="robot_state_publisher">
    <param name="robot_description" value="$(command 'xacro $(var urdf_path)')"/>
  </node>
  <node pkg="joint_state_publisher_gui" exec="joint_state_publisher_gui"/>

  <!-- Connect4 robot_state_publisher (publishes visual meshes) -->
  <node pkg="robot_state_publisher" exec="robot_state_publisher" name="connect4_state_publisher">
    <param name="robot_description" value="$(command 'xacro $(var connect4_urdf_path)')"/>
    <remap from="/robot_description" to="/connect4_description"/>
  </node>

  <!-- Static TF publisher for all Connect4 parts -->
  <node pkg="vw-assign1-2025-parol6-static-pkg" exec="pub" name="connect4_static_tf">
    <param name="x" value="$(var x)"/>
    <param name="y" value="$(var y)"/>
    <param name="z" value="$(var z)"/>
    <param name="roll" value="$(var roll)"/>
    <param name="pitch" value="$(var pitch)"/>
    <param name="yaw" value="$(var yaw)"/>
  </node>

  <!-- RViz -->
  <node pkg="rviz2" exec="rviz2" output="screen" args="-d $(var rviz_config_path)"/>
</launch>
